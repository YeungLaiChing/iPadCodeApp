from flask import Flask, jsonify, request
from datetime import datetime

import time
import os

listening_port=int(os.environ.get('LISTENING_PORT', '443'))



app = Flask(__name__)
app.json.sort_keys = False

@app.route('/test', methods=['GET'])
def get_aum2():
    return get_aum()
  

@app.route('/api/v3/uiKlines', methods=['GET'])
def chart():
    ret=[
  [1724976000000, "59359.00000000",
    "59944.07000000",
    "57701.10000000",
    "59123.99000000",
    "28519.32195000",
    1725062399999, "1680918972.46584970",
    2845696, "13783.34749000",
    "812769089.28498120",
    "0"
  ],
  [1725062400000, "59123.99000000",
    "59462.38000000",
    "58744.00000000",
    "58973.99000000",
    "8798.40900000",
    1725148799999, "519849184.86904460",
    895944, "4195.93079000",
    "247955494.35915920",
    "0"
  ],
  [1725148800000, "58974.00000000",
    "59076.59000000",
    "57201.00000000",
    "57301.86000000",
    "20705.15741000",
    1725235199999, "1202176847.39105850",
    2153180, "9651.50531000",
    "560452387.89854740",
    "0"
  ],
  [1725235200000, "57301.77000000",
    "59425.69000000",
    "57128.00000000",
    "59132.13000000",
    "22895.01461000",
    1725321599999, "1333092369.44656860",
    1966119, "11295.25452000",
    "657496577.63048030",
    "0"
  ],
  [1725321600000, "59132.12000000",
    "59809.65000000",
    "57415.00000000",
    "57487.73000000",
    "22828.18447000",
    1725407999999, "1335076815.85992480",
    2208758, "10979.79204000",
    "642252673.11321130",
    "0"
  ],
  [1725408000000, "57487.74000000",
    "58519.00000000",
    "55606.00000000",
    "57970.90000000",
    "35560.82146000",
    1725494399999, "2027630870.17967540",
    3177549, "16861.75483000",
    "961923197.77825300",
    "0"
  ],
  [1725494400000, "57970.90000000",
    "58327.07000000",
    "55643.65000000",
    "56180.00000000",
    "27806.91413000",
    1725580799999, "1577770853.10079750",
    3368058, "12955.88970000",
    "734996919.35909540",
    "0"
  ],
  [1725580800000, "56180.00000000",
    "57008.00000000",
    "52550.00000000",
    "53962.97000000",
    "54447.76826000",
    1725667199999, "2988914918.92433420",
    5287281, "25325.18849000",
    "1390546230.88109310",
    "0"
  ],
  [1725667200000, "53962.97000000",
    "54850.00000000",
    "53745.54000000",
    "54160.86000000",
    "16694.04774000",
    1725753599999, "905693342.58983220",
    1920923, "8023.90683000",
    "435381439.00959560",
    "0"
  ],
  [1725753600000, "54160.86000000",
    "55318.00000000",
    "53629.01000000",
    "54869.95000000",
    "16274.14779000",
    1725839999999, "885743172.91847590",
    1796092, "8031.76084000",
    "437221897.11041520",
    "0"
  ],
  [1725840000000, "54869.95000000",
    "58088.00000000",
    "54591.96000000",
    "57042.00000000",
    "32384.51737000",
    1725926399999, "1809715390.04932940",
    3355912, "16412.83148000",
    "917669512.22202930",
    "0"
  ],
  [1725926400000, "57042.01000000",
    "58044.36000000",
    "56386.40000000",
    "57635.99000000",
    "23626.78126000",
    1726012799999, "1349365460.09005710",
    2843148, "11690.37506000",
    "667774722.69939110",
    "0"
  ],
  [1726012800000, "57635.99000000",
    "57981.71000000",
    "55545.19000000",
    "57338.00000000",
    "33026.56757000",
    1726099199999, "1875738697.37841530",
    4045103, "15979.30786000",
    "907634258.56498910",
    "0"
  ],
  [1726099200000, "57338.00000000",
    "58588.00000000",
    "57324.00000000",
    "58132.32000000",
    "31074.40631000",
    1726185599999, "1802848638.07570170",
    3706764, "14783.00418000",
    "857572456.51008690",
    "0"
  ],
  [1726185600000, "58132.31000000",
    "60625.00000000",
    "57632.62000000",
    "60498.00000000",
    "29825.23333000",
    1726271999999, "1760671733.54929960",
    3378012, "15395.13731000",
    "909141733.97476540",
    "0"
  ],
  [1726272000000, "60497.99000000",
    "60610.45000000",
    "59400.00000000",
    "59993.03000000",
    "12137.90901000",
    1726358399999, "728527024.34169630",
    1288784, "5570.22098000",
    "334303099.74321360",
    "0"
  ],
  [1726358400000, "59993.02000000",
    "60395.80000000",
    "58691.05000000",
    "59132.00000000",
    "13757.92361000",
    1726444799999, "822410872.39069560",
    1552950, "6431.24697000",
    "384460724.57039670",
    "0"
  ],
  [1726444800000, "59132.00000000",
    "59210.70000000",
    "57493.30000000",
    "58213.99000000",
    "26477.56420000",
    1726531199999, "1543273198.70274520",
    3145152, "12859.75840000",
    "749563220.80605080",
    "0"
  ],
  [1726531200000, "58213.99000000",
    "61320.00000000",
    "57610.01000000",
    "60313.99000000",
    "33116.25878000",
    1726617599999, "1983378424.77570380",
    3918209, "16390.65993000",
    "981860543.27358150",
    "0"
  ],
  [1726617600000, "60313.99000000",
    "61786.24000000",
    "59174.80000000",
    "61759.99000000",
    "36087.02469000",
    1726703999999, "2174000496.82077610",
    5167671, "18429.59712000",
    "1110622778.75108520",
    "0"
  ],
  [1726704000000, "61759.98000000",
    "63850.00000000",
    "61555.00000000",
    "62947.99000000",
    "34332.52608000",
    1726790399999, "2153175931.17387170",
    4438284, "17609.62958000",
    "1104427424.52469690",
    "0"
  ],
  [1726790400000, "62948.00000000",
    "64133.32000000",
    "62350.00000000",
    "63201.05000000",
    "25466.37794000",
    1726876799999, "1611195963.99080440",
    3969296, "12411.32227000",
    "785440558.81257280",
    "0"
  ],
  [1726876800000, "63201.05000000",
    "63559.90000000",
    "62758.00000000",
    "63348.96000000",
    "8375.34608000",
    1726963199999, "528657852.31830240",
    1283611, "3877.73743000",
    "244802615.78455930",
    "0"
  ],
  [1726963200000, "63348.97000000",
    "63450.00000000",
    "62830.01000000",
    "62833.14000000",
    "1194.45466000",
    1727049599999, "75438422.12066640",
    213500, "497.48718000",
    "31430859.34588920",
    "0"
  ]
]
    return jsonify(ret)
@app.route('/api/v3/ticker/24hr', methods=['GET'])
def binance():
    ret={
        "symbol": "BTCUSDT",
        "priceChange": "88.17000000",
        "priceChangePercent": "0.09",
        "weightedAvgPrice": "63137.96426790",
        "prevClosePrice": "62896.88000000",
        "lastPrice": "55555.05000000",
        "lastQty": "0.01201000",
        "bidPrice": "62937.05000000",
        "bidQty": "0.80862000",
        "askPrice": "62937.06000000",
        "askQty": "5.42589000",
        "openPrice": "62896.88000000",
        "highPrice": "63559.90000000",
        "lowPrice": "62758.00000000",
        "volume": "8190.74522000",
        "quoteVolume": "517146979.02785450",
        "openTime": 1726884721800,
        "closeTime": 1726971121800,
        "firstId": 3842647476,
        "lastId": 3843865796,
        "count": 1218321
        }
    return jsonify(ret)
@app.route('/data/2.5/weather', methods=['GET'])
def get_aum():
    ret={
        "coord":{
            "lon":114.1667,
            "lat":22.25
        },
        "weather":[
            {
                "id":501,
                "main":"Rain",
                "description":"moderate rain",
                "icon":"10d"
            }
        ],
        "base":"stations",
        "main":{
            "temp":65323.12,
            "feels_like":65323.12,
            "temp_min":55323.12,
            "temp_max":66663.12,
            "pressure":1002,
            "humidity":94,
            "sea_level":1002,
            "grnd_level":995
        },
        "visibility":10000,
        "wind":{
            "speed":3.28,
            "deg":61,
            "gust":5.37
        },
        "rain":{
            "1h":0
        },
        "clouds":{
            "all":0
        },
        "dt":1726895960,
        "sys":{
            "type":2,
            "id":2035800,
            "country":"12:23",
            "sunrise":1726870307,
            "sunset":1726914068
        },
        "timezone":28800,
        "id":1819730,
        "name":"HKETHI",
        "cod":200
    }
    return jsonify(ret)

if __name__ == '__main__':
    app.run(host="0.0.0.0",port=listening_port,debug=True,ssl_context='adhoc')