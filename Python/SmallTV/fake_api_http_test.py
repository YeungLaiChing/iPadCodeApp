from flask import Flask, jsonify, request
from datetime import datetime

import time
import os

listening_port=int(os.environ.get('LISTENING_PORT', '80'))



app = Flask(__name__)
app.json.sort_keys = False

@app.route('/test', methods=['GET'])
def get_aum2():
    return get_aum()
#/v8/finance/chart/BTC-USD?interval=1d&range=44d


@app.route('/v8/finance/chart/<symbol>', methods=['GET'])
def chart_2(symbol):
    ret={
    "chart": {
        "result": [
        {
            "meta": {
            "currency": "USD",
            "symbol": "BTC-USD",
            "exchangeName": "CCC",
            "fullExchangeName": "CCC",
            "instrumentType": "CRYPTOCURRENCY",
            "firstTradeDate": 1410912000,
            "regularMarketTime": 1728479520,
            "hasPrePostMarketData": "false",
            "gmtoffset": 0,
            "timezone": "UTC",
            "exchangeTimezoneName": "UTC",
            "regularMarketPrice": 61858.51,
            "fiftyTwoWeekHigh": 62488.5,
            "fiftyTwoWeekLow": 61781.508,
            "regularMarketDayHigh": 62488.5,
            "regularMarketDayLow": 61781.508,
            "regularMarketVolume": 26741962752,
            "longName": "Bitcoin USD",
            "shortName": "Bitcoin USD",
            "chartPreviousClose": 59504.133,
            "priceHint": 2,
            "currentTradingPeriod": {
                "pre": {
                "timezone": "UTC",
                "start": 1728432000,
                "end": 1728432000,
                "gmtoffset": 0
                },
                "regular": {
                "timezone": "UTC",
                "start": 1728432000,
                "end": 1728518340,
                "gmtoffset": 0
                },
                "post": {
                "timezone": "UTC",
                "start": 1728518340,
                "end": 1728518340,
                "gmtoffset": 0
                }
            },
            "dataGranularity": "1d",
            "range": "44d",
            "validRanges": [
                "1d",
                "5d",
                "1mo",
                "3mo",
                "6mo",
                "1y",
                "2y",
                "5y",
                "10y",
                "ytd",
                "max"
            ]
            },
            "timestamp": [1724716800, 1724803200, 1724889600, 1724976000, 1725062400, 1725148800, 1725235200, 1725321600, 1725408000, 1725494400, 1725580800, 1725667200, 1725753600, 1725840000, 1725926400, 1726012800, 1726099200, 1726185600, 1726272000, 1726358400, 1726444800, 1726531200, 1726617600, 1726704000, 1726790400, 1726876800, 1726963200, 1727049600, 1727136000, 1727222400, 1727308800, 1727395200, 1727481600, 1727568000, 1727654400, 1727740800, 1727827200, 1727913600, 1728000000, 1728086400, 1728172800, 1728259200, 1728345600, 1728479520],
            "indicators": {
            "quote": [
                {
                "high": [63210.796875, 60236.44921875, 61184.08203125, 59896.88671875, 59432.59375, 59062.0703125, 59403.0703125, 59815.05859375, 58511.5703125, 58300.58203125, 56976.109375, 54838.14453125, 55300.859375, 58041.125, 58029.9765625, 57991.3203125, 58534.359375, 60648.0234375, 60656.72265625, 60381.91796875, 59205.51171875, 61316.08984375, 61664.06640625, 63872.44140625, 64119.53125, 63543.359375, 63993.421875, 64733.55859375, 64695.21484375, 64804.50390625, 65790.796875, 66480.6953125, 66255.53125, 66069.34375, 65635.0546875, 64110.98046875, 62357.6875, 61469.0390625, 62465.9921875, 62371.0234375, 62959.5703125, 64443.70703125, 63174.3046875, 62488.5],
                "open": [62879.70703125, 59507.92578125, 59027.46875, 59388.6015625, 59117.48046875, 58969.80078125, 57326.96875, 59106.19140625, 57430.34765625, 57971.703125, 56160.19140625, 53949.0859375, 54147.93359375, 54851.88671875, 57020.09765625, 57650.2890625, 57343.171875, 58130.32421875, 60569.1171875, 60000.7265625, 59185.2265625, 58192.5078125, 60309, 61651.15625, 62941.42578125, 63184.33984375, 63396.8046875, 63643.1015625, 63326.83984375, 64302.58984375, 63138.546875, 65180.6640625, 65792.1796875, 65888.8984375, 65634.65625, 63335.60546875, 60836.32421875, 60632.484375, 60754.625, 62067.609375, 62084.98828125, 62819.109375, 62221.64453125, 62122.8359375],
                "low": [58116.75, 57890.67578125, 58786.2265625, 57768.53125, 58768.78515625, 57217.82421875, 57136.02734375, 57425.16796875, 55673.1640625, 55712.453125, 52598.69921875, 53740.0703125, 53653.7578125, 54598.43359375, 56419.4140625, 55567.33984375, 57330.1015625, 57650.11328125, 59517.8828125, 58696.30859375, 57501.33984375, 57628.0703125, 59218.25390625, 61609.8671875, 62364.60546875, 62783.10546875, 62440.7265625, 62628.078125, 62737.41796875, 62945.375, 62669.26953125, 64852.9921875, 65458.03515625, 65450.015625, 62873.6171875, 60189.27734375, 59996.94921875, 59878.8046875, 60459.94140625, 61689.58203125, 61833.1484375, 62152.55078125, 61843.5625, 61781.5078125],
                "close": [59504.1328125, 59027.625, 59388.1796875, 59119.4765625, 58969.8984375, 57325.48828125, 59112.48046875, 57431.0234375, 57971.5390625, 56160.48828125, 53948.75390625, 54139.6875, 54841.56640625, 57019.53515625, 57648.7109375, 57343.171875, 58127.01171875, 60571.30078125, 60005.12109375, 59182.8359375, 58192.5078125, 60308.5390625, 61649.6796875, 62940.45703125, 63192.9765625, 63394.83984375, 63648.7109375, 63329.80078125, 64301.96875, 63143.14453125, 65181.01953125, 65790.6640625, 65887.6484375, 65635.3046875, 63329.5, 60837.0078125, 60632.78515625, 60759.40234375, 62067.4765625, 62089.94921875, 62818.953125, 62236.66015625, 62131.96875, 61858.51171875],
                "volume": [39103882198, 40289564698, 32224990582, 32292756405, 12403470760, 24592449997, 27036454524, 26666961053, 35627680312, 31030280656, 49361693566, 19061486526, 18268287531, 34618096173, 28857630507, 37049062672, 33835707949, 32490528356, 16428405496, 18120960867, 32032822113, 38075570118, 40990702891, 42710252573, 35177164222, 14408616220, 20183348802, 31400285425, 29938335243, 25078377700, 36873129847, 32058813449, 15243637984, 14788214575, 37112957475, 50220923500, 40762722398, 36106447279, 29585472513, 13305410749, 14776233667, 34253562610, 28134475157, 26741962752]
                }
            ],
            "adjclose": [
                {
                "adjclose": [59504.1328125, 59027.625, 59388.1796875, 59119.4765625, 58969.8984375, 57325.48828125, 59112.48046875, 57431.0234375, 57971.5390625, 56160.48828125, 53948.75390625, 54139.6875, 54841.56640625, 57019.53515625, 57648.7109375, 57343.171875, 58127.01171875, 60571.30078125, 60005.12109375, 59182.8359375, 58192.5078125, 60308.5390625, 61649.6796875, 62940.45703125, 63192.9765625, 63394.83984375, 63648.7109375, 63329.80078125, 64301.96875, 63143.14453125, 65181.01953125, 65790.6640625, 65887.6484375, 65635.3046875, 63329.5, 60837.0078125, 60632.78515625, 60759.40234375, 62067.4765625, 62089.94921875, 62818.953125, 62236.66015625, 62131.96875, 61858.51171875]
                }
            ]
            }
        }
        ],
        "error": "null"
    }
    }
    return ret

@app.route('/api/v3/uiKlines', methods=['GET'])
def chart():
    ret=[
  [1724976000000, "59359.00000000",
    "59944.07000000",
    "57701.10000000",
    "59123.99000000",
    "28519.32195000",
    1725062399999, "1680918972.46584970",
    2845696, "13783.34749000",
    "812769089.28498120",
    "0"
  ],
  [1725062400000, "59123.99000000",
    "59462.38000000",
    "58744.00000000",
    "58973.99000000",
    "8798.40900000",
    1725148799999, "519849184.86904460",
    895944, "4195.93079000",
    "247955494.35915920",
    "0"
  ],
  [1725148800000, "58974.00000000",
    "59076.59000000",
    "57201.00000000",
    "57301.86000000",
    "20705.15741000",
    1725235199999, "1202176847.39105850",
    2153180, "9651.50531000",
    "560452387.89854740",
    "0"
  ],
  [1725235200000, "57301.77000000",
    "59425.69000000",
    "57128.00000000",
    "59132.13000000",
    "22895.01461000",
    1725321599999, "1333092369.44656860",
    1966119, "11295.25452000",
    "657496577.63048030",
    "0"
  ],
  [1725321600000, "59132.12000000",
    "59809.65000000",
    "57415.00000000",
    "57487.73000000",
    "22828.18447000",
    1725407999999, "1335076815.85992480",
    2208758, "10979.79204000",
    "642252673.11321130",
    "0"
  ],
  [1725408000000, "57487.74000000",
    "58519.00000000",
    "55606.00000000",
    "57970.90000000",
    "35560.82146000",
    1725494399999, "2027630870.17967540",
    3177549, "16861.75483000",
    "961923197.77825300",
    "0"
  ],
  [1725494400000, "57970.90000000",
    "58327.07000000",
    "55643.65000000",
    "56180.00000000",
    "27806.91413000",
    1725580799999, "1577770853.10079750",
    3368058, "12955.88970000",
    "734996919.35909540",
    "0"
  ],
  [1725580800000, "56180.00000000",
    "57008.00000000",
    "52550.00000000",
    "53962.97000000",
    "54447.76826000",
    1725667199999, "2988914918.92433420",
    5287281, "25325.18849000",
    "1390546230.88109310",
    "0"
  ],
  [1725667200000, "53962.97000000",
    "54850.00000000",
    "53745.54000000",
    "54160.86000000",
    "16694.04774000",
    1725753599999, "905693342.58983220",
    1920923, "8023.90683000",
    "435381439.00959560",
    "0"
  ],
  [1725753600000, "54160.86000000",
    "55318.00000000",
    "53629.01000000",
    "54869.95000000",
    "16274.14779000",
    1725839999999, "885743172.91847590",
    1796092, "8031.76084000",
    "437221897.11041520",
    "0"
  ],
  [1725840000000, "54869.95000000",
    "58088.00000000",
    "54591.96000000",
    "57042.00000000",
    "32384.51737000",
    1725926399999, "1809715390.04932940",
    3355912, "16412.83148000",
    "917669512.22202930",
    "0"
  ],
  [1725926400000, "57042.01000000",
    "58044.36000000",
    "56386.40000000",
    "57635.99000000",
    "23626.78126000",
    1726012799999, "1349365460.09005710",
    2843148, "11690.37506000",
    "667774722.69939110",
    "0"
  ],
  [1726012800000, "57635.99000000",
    "57981.71000000",
    "55545.19000000",
    "57338.00000000",
    "33026.56757000",
    1726099199999, "1875738697.37841530",
    4045103, "15979.30786000",
    "907634258.56498910",
    "0"
  ],
  [1726099200000, "57338.00000000",
    "58588.00000000",
    "57324.00000000",
    "58132.32000000",
    "31074.40631000",
    1726185599999, "1802848638.07570170",
    3706764, "14783.00418000",
    "857572456.51008690",
    "0"
  ],
  [1726185600000, "58132.31000000",
    "60625.00000000",
    "57632.62000000",
    "60498.00000000",
    "29825.23333000",
    1726271999999, "1760671733.54929960",
    3378012, "15395.13731000",
    "909141733.97476540",
    "0"
  ],
  [1726272000000, "60497.99000000",
    "60610.45000000",
    "59400.00000000",
    "59993.03000000",
    "12137.90901000",
    1726358399999, "728527024.34169630",
    1288784, "5570.22098000",
    "334303099.74321360",
    "0"
  ],
  [1726358400000, "59993.02000000",
    "60395.80000000",
    "58691.05000000",
    "59132.00000000",
    "13757.92361000",
    1726444799999, "822410872.39069560",
    1552950, "6431.24697000",
    "384460724.57039670",
    "0"
  ],
  [1726444800000, "59132.00000000",
    "59210.70000000",
    "57493.30000000",
    "58213.99000000",
    "26477.56420000",
    1726531199999, "1543273198.70274520",
    3145152, "12859.75840000",
    "749563220.80605080",
    "0"
  ],
  [1726531200000, "58213.99000000",
    "61320.00000000",
    "57610.01000000",
    "60313.99000000",
    "33116.25878000",
    1726617599999, "1983378424.77570380",
    3918209, "16390.65993000",
    "981860543.27358150",
    "0"
  ],
  [1726617600000, "60313.99000000",
    "61786.24000000",
    "59174.80000000",
    "61759.99000000",
    "36087.02469000",
    1726703999999, "2174000496.82077610",
    5167671, "18429.59712000",
    "1110622778.75108520",
    "0"
  ],
  [1726704000000, "61759.98000000",
    "63850.00000000",
    "61555.00000000",
    "62947.99000000",
    "34332.52608000",
    1726790399999, "2153175931.17387170",
    4438284, "17609.62958000",
    "1104427424.52469690",
    "0"
  ],
  [1726790400000, "62948.00000000",
    "64133.32000000",
    "62350.00000000",
    "63201.05000000",
    "25466.37794000",
    1726876799999, "1611195963.99080440",
    3969296, "12411.32227000",
    "785440558.81257280",
    "0"
  ],
  [1726876800000, "63201.05000000",
    "63559.90000000",
    "62758.00000000",
    "63348.96000000",
    "8375.34608000",
    1726963199999, "528657852.31830240",
    1283611, "3877.73743000",
    "244802615.78455930",
    "0"
  ],
  [1726963200000, "63348.97000000",
    "63450.00000000",
    "62830.01000000",
    "62833.14000000",
    "1194.45466000",
    1727049599999, "75438422.12066640",
    213500, "497.48718000",
    "31430859.34588920",
    "0"
  ]
]
    return jsonify(ret)
@app.route('/api/v3/ticker/24hr', methods=['GET'])
def binance():
    ret={
        "symbol": "ABCD",
        "priceChange": "88.17000000",
        "priceChangePercent": "0.09",
        "weightedAvgPrice": "63137.96426790",
        "prevClosePrice": "62896.88000000",
        "lastPrice": "55555.05000000",
        "lastQty": "0.01201000",
        "bidPrice": "62937.05000000",
        "bidQty": "0.80862000",
        "askPrice": "62937.06000000",
        "askQty": "5.42589000",
        "openPrice": "62896.88000000",
        "highPrice": "63559.90000000",
        "lowPrice": "62758.00000000",
        "volume": "8190.74522000",
        "quoteVolume": "517146979.02785450",
        "openTime": 1726884721800,
        "closeTime": 1726971121800,
        "firstId": 3842647476,
        "lastId": 3843865796,
        "count": 1218321
        }
    return jsonify(ret)
@app.route('/data/2.5/weather', methods=['GET'])
def get_aum():
    ret={
        "coord":{
            "lon":114.1667,
            "lat":22.25
        },
        "weather":[
            {
                "id":501,
                "main":"Rain",
                "description":"moderate rain",
                "icon":"10d"
            }
        ],
        "base":"stations",
        "main":{
            "temp":65323.12,
            "feels_like":65323.12,
            "temp_min":55323.12,
            "temp_max":66663.12,
            "pressure":1002,
            "humidity":94,
            "sea_level":1002,
            "grnd_level":995
        },
        "visibility":10000,
        "wind":{
            "speed":3.28,
            "deg":61,
            "gust":5.37
        },
        "rain":{
            "1h":0
        },
        "clouds":{
            "all":0
        },
        "dt":1726895960,
        "sys":{
            "type":2,
            "id":2035800,
            "country":"12:23",
            "sunrise":1726870307,
            "sunset":1726914068
        },
        "timezone":28800,
        "id":1819730,
        "name":"HKETHI",
        "cod":200
    }
    return jsonify(ret)

if __name__ == '__main__':
    app.run(host="0.0.0.0",port=listening_port,debug=True)